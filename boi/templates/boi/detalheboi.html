{% extends 'base.html' %}
{% block title %}Ficha do Boi{% endblock %}

{% block content %}
<div class="lista-container">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
        <h2>Ficha do Boi</h2>
        <a href="{% url 'atualizaboi' boi.pk %}" class="botao-acao botao-adicionar" style="background-color: #f59e0b;">
          <i class='bx bx-edit'></i> Editar
        </a>
    </div>
  <div class="form-grid">
    <div class="form-group">
      <label>Brinco</label>
      <input type="text" value="{{ boi.brinco }}" disabled>
    </div>
    <div class="form-group">
      <label>Chip</label>
      <input type="text" value="{{ boi.chip }}" disabled>
    </div>
    <div class="form-group">
      <label>Status</label>
      <input type="text" value="{{ boi.status_boi.nome_status }}" disabled>
    </div>
  </div>

  <div style="margin: 20px 0;">
    <button class="botao-acao botao-buscar" onclick="mostrarAba('informacoes')">Informações</button>
    <button class="botao-acao botao-limpar" onclick="mostrarAba('saida')">Saída</button>
    <button class="botao-acao botao-limpar" onclick="mostrarAba('morte')">Morte</button>
    <button class="botao-acao botao-limpar" onclick="mostrarAba('pesagens')">Pesagens</button>
  </div>

  <div id="informacoes" class="aba-ativa">
    <div class="form-grid">
      <div class="form-group">
        <label>Sexo</label>
        <input type="text" value="{{ boi.sexo.tipo_sexo }}" disabled>
      </div>
      <div class="form-group">
        <label>Raça</label>
        <input type="text" value="{{ boi.raca.nome_raca }}" disabled>
      </div>
      <div class="form-group">
        <label>Fornecedor</label>
        <input type="text" value="{{ boi.fornecedor.nome_fornecedor }}" disabled>
      </div>
      <div class="form-group">
        <label>Lote</label>
        <input type="text" value="{{ boi.lote.nome_lote }}" disabled>
      </div>
      <div class="form-group">
        <label>Peso de Entrada</label>
        <input type="text" value="{{ boi.peso_entrada }}" disabled>
      </div>
      <div class="form-group">
        <label>Data de Nascimento</label>
        <input type="text" value="{{ boi.data_nascimento|date:'d/m/Y' }}" disabled>
      </div>
      <div class="form-group">
        <label>Data de Entrada</label>
        <input type="text" value="{{ boi.data_entrada|date:'d/m/Y' }}" disabled>
      </div>
      <div class="form-group">
        <label>Peso Projetado</label>
        <input type="text" value="{{ peso_projetado.peso_projetado }} kg - {{ peso_projetado.data_projetado|date:'d/m/Y' }}" disabled>
      </div>
    </div>
  </div>

  <div id="saida" class="aba-conteudo hidden">
    <div class="form-grid">
      <div class="form-group">
        <label>Peso de Saída</label>
        <input type="text" value="{{ boi.peso_saida }}" disabled>
      </div>
      <div class="form-group">
        <label>Data de Saída</label>
        <input type="text" value="{{ boi.data_saida|date:'d/m/Y' }}" disabled>
      </div>
    </div>
  </div>

  <div id="morte" class="aba-conteudo hidden">
    <div class="form-grid">
      <div class="form-group">
        <label>Data de Morte</label>
        <input type="text" value="{{ boi.data_morte|date:'d/m/Y' }}" disabled>
      </div>
      <div class="form-group">
        <label>Motivo da Morte</label>
        <input type="text" value="{{ boi.motivo_morte }}" disabled>
      </div>
      <div class="form-group">
        <label>Necropsia</label>
        <input type="text" value="{% if boi.necropsia %}Sim{% else %}Não{% endif %}" disabled>
      </div>
    </div>
  </div>

  <div id="pesagens" class="aba-conteudo hidden">
    <table class="tabela-lista">
      <thead>
        <tr>
          <th>Data</th>
          <th>Peso (kg)</th>
        </tr>
      </thead>
      <tbody>
        {% for pesagem in boi.pesagens.all %}
        <tr>
          <td>{{ pesagem.data_movimentacao|date:'d/m/Y' }}</td>
          <td>{{ pesagem.peso_movimentacao }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="2" class="sem-registro">Nenhuma pesagem registrada.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<script>
function mostrarAba(id) {
  document.querySelectorAll('.aba-conteudo, .aba-ativa').forEach(el => el.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
}
</script>

<style>
.hidden { display: none; }
</style>
{% endblock %}